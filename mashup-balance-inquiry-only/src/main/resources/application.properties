# 取得先メタデータはコンテナ内の keycloak:8080 を使う（現状どおり）
quarkus.oidc.auth-server-url=http://keycloak:8080/realms/demo-realm

# ← ここを追加：トークン検証時に受け入れる "iss" を localhost に合わせる
quarkus.oidc.token.issuer=http://localhost:8080/realms/demo-realm

# サービスとして Bearer を受ける
quarkus.oidc.application-type=service

# OIDC を無効化している行があれば削除 or true にする
# quarkus.oidc.enabled=false   ← これがあると認証自体が働きません（削除）

# 役割はアクセストークンから取り、Keycloak標準のパスを使う（現状どおり）
quarkus.oidc.roles.source=accesstoken
quarkus.oidc.roles.role-claim-path=realm_access/roles

# デバッグ（必要なら）
quarkus.log.category."io.quarkus.oidc".level=DEBUG
quarkus.log.category."io.quarkus.security".level=DEBUG

# 認証済みなら /balances と /api/balances を許可
quarkus.http.auth.permission.balance.paths=/balances/*,/api/balances/*
quarkus.http.auth.permission.balance.policy=authenticated

# #「read ロールが要る」仕様にしたいなら
# quarkus.http.auth.policy.balance-read.roles-allowed=read
# quarkus.http.auth.permission.balance.paths=/balances/*,/api/balances/*
# quarkus.http.auth.permission.balance.policy=balance-read

# --- (1) RestClient用 OIDC クライアント ---
quarkus.oidc-client.auth-server-url=http://keycloak:8080/realms/demo-realm
quarkus.oidc-client.client-id=mashup-client
quarkus.oidc-client.credentials.secret=changeit
quarkus.oidc-client.grant.type=client
quarkus.oidc-client.discovery-enabled=false
quarkus.oidc-client.token-path=/protocol/openid-connect/token

# --- (2) RestClient の接続先URL（ベースURL） ---
quarkus.rest-client.savings-api.url=http://mashup-savings-term-deposits:8080/api
quarkus.rest-client.time-api.url=http://mashup-savings-term-deposits:8080/api


quarkus.http.port=9000


# 送信/受信ログをDEBUGで
quarkus.log.category."org.jboss.resteasy.reactive.client".level=DEBUG

